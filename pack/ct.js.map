{"version":3,"file":"ct.js?4014061d547f667b61c3","mappings":"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","sources":["webpack://@atendesimples/call-tracking/./node_modules/unfetch/polyfill/index.js","webpack://@atendesimples/call-tracking/webpack/bootstrap","webpack://@atendesimples/call-tracking/webpack/runtime/compat get default export","webpack://@atendesimples/call-tracking/webpack/runtime/define property getters","webpack://@atendesimples/call-tracking/webpack/runtime/hasOwnProperty shorthand","webpack://@atendesimples/call-tracking/./src/index.ts"],"sourcesContent":["self.fetch||(self.fetch=function(e,n){return n=n||{},new Promise(function(t,r){var s=new XMLHttpRequest,o=[],u={},a=function e(){return{ok:2==(s.status/100|0),statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:e,headers:{keys:function(){return o},entries:function(){return o.map(function(e){return[e,s.getResponseHeader(e)]})},get:function(e){return s.getResponseHeader(e)},has:function(e){return null!=s.getResponseHeader(e)}}}};for(var i in s.open(n.method||\"get\",e,!0),s.onload=function(){s.getAllResponseHeaders().toLowerCase().replace(/^(.+?):/gm,function(e,n){u[n]||o.push(u[n]=n)}),t(a())},s.onerror=r,s.withCredentials=\"include\"==n.credentials,n.headers)s.setRequestHeader(i,n.headers[i]);s.send(n.body||null)})});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import 'unfetch/polyfill'\n\nclass CallTracking {\n  #token: any\n  #fallback: any\n  #html: any\n\n  constructor(props: CallTrackingProps) {\n    this.#token = props.token\n    this.#fallback = props.fallback\n    this.#html = props.html\n  }\n\n  googleClientId() {\n    let ga = document.cookie.split(';').find((o) => o.match(/_ga=(.+?)/))\n    if (!ga) return ''\n\n    return ga.split('.').slice(-2).join('.')\n  }\n\n  load() {\n    const url = `${process.env.CALL_TRACKING_URL}/2/${this.#token}`\n\n    const options = {\n      method: 'POST',\n      data: JSON.stringify({ cid: this.googleClientId() }),\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    }\n\n    let $el = document.querySelector(this.#html.selector)\n\n    if (!$el) {\n      return this.#fallback.error\n    }\n\n    const checkinRequest = () => {\n      return fetch(url, options).then(async (response) => {\n        const data = await response.json()\n\n        // update HTML ELement\n        $el.textContent = data?.number || this.#fallback.error\n\n        return data?.number || this.#fallback.error\n      })\n    }\n\n    if (this.#html.event == 'load') {\n      checkinRequest()\n    } else if (this.#html.event == 'click') {\n      $el.addEventListener('click', async () => {\n        if (this.#html.loading) {\n          $el.innerHTML = (await this.#html.loading()) || '.'\n        } else {\n          $el.textContent = '...'\n        }\n\n        checkinRequest()\n      })\n    }\n  }\n}\n\nconst AtendeSimples = { CallTracking }\nwindow.AtendeSimples = AtendeSimples\n\nexport default AtendeSimples\n"],"names":["self","fetch","e","n","Promise","t","r","s","XMLHttpRequest","o","u","a","ok","status","statusText","url","responseURL","text","resolve","responseText","json","then","JSON","parse","blob","Blob","response","clone","headers","keys","entries","map","getResponseHeader","get","has","i","open","method","onload","getAllResponseHeaders","toLowerCase","replace","push","onerror","withCredentials","credentials","setRequestHeader","send","body","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","getter","__esModule","d","definition","key","Object","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","AtendeSimples","CallTracking","constructor","props","this","token","fallback","html","googleClientId","ga","document","cookie","split","find","match","slice","join","load","options","data","stringify","cid","$el","querySelector","selector","error","checkinRequest","textContent","number","event","addEventListener","loading","innerHTML","window"],"sourceRoot":""}